<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrystalNetwork Status</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a;
        }
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 font-sans antialiased min-h-screen flex flex-col items-center p-4">

    <header class="w-full max-w-xl mb-8 text-center">
        <div class="flex items-center justify-center space-x-2 mb-2">
            <h1 class="text-4xl font-extrabold text-white tracking-tight">System Status</h1>
            <span id="overall-status-icon" class="text-3xl transition-transform duration-300"></span>
        </div>
        <p class="text-slate-400 text-lg">Real-time operational status for all services.</p>
        <p class="text-sm text-slate-500 mt-1">Last updated: <span id="last-updated-time"></span></p>
    </header>

    <main id="status-container" class="w-full max-w-xl grid gap-6">
    </main>

    <footer class="mt-auto w-full max-w-xl text-center py-4 text-slate-500 text-sm">
        <p>&copy; 2025 All Rights Reserved.</p>
    </footer>

    <script>
        const STATUS_URL = 'https://crystalnetwork.qzz.io/';
        const FETCH_TIMEOUT = 10000;
        const THRESHOLDS = {
            operational: 1000,
            degraded: 8000,
        };
        const services = [
            { id: 'web-server', name: 'Web Server', status: 'loading', details: 'The web server is responsible for hosting the main website. It processes all incoming requests and shows the requested data.' },
            { id: 'discord-bot', name: 'Discord Bot', status: 'loading', details: 'The Discord bot is responsible for sending your appeals to the staff team for appeal.' },
        ];
        const statusConfig = {
            'operational': {
                bg: 'bg-green-900',
                text: 'text-green-300',
                border: 'border-green-600',
                icon: '<i class="fas fa-check-circle text-green-500"></i>',
                message: 'Operational'
            },
            'degraded': {
                bg: 'bg-yellow-900',
                text: 'text-yellow-300',
                border: 'border-yellow-600',
                icon: '<i class="fas fa-exclamation-triangle text-yellow-500"></i>',
                message: 'Degraded Performance'
            },
            'outage': {
                bg: 'bg-red-900',
                text: 'text-red-300',
                border: 'border-red-600',
                icon: '<i class="fas fa-times-circle text-red-500"></i>',
                message: 'Outage'
            },
            'loading': {
                bg: 'bg-slate-800',
                text: 'text-slate-500',
                border: 'border-slate-700',
                icon: '<i class="fas fa-spinner fa-spin text-slate-400"></i>',
                message: 'Checking status...'
            }
        };

        const statusContainer = document.getElementById('status-container');
        const overallStatusIcon = document.getElementById('overall-status-icon');
        const lastUpdatedTime = document.getElementById('last-updated-time');

        const createServiceCard = (service) => {
            const config = statusConfig[service.status];
            const card = document.createElement('div');
            card.className = `p-6 ${config.bg} rounded-xl border-l-4 ${config.border} shadow-lg transition-transform hover:scale-105 transform duration-300 ease-in-out cursor-pointer`;
            card.setAttribute('data-service-id', service.id);
            card.innerHTML = `
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-2">
                        <h3 class="text-xl font-semibold text-white">${service.name}</h3>
                        <i class="fas fa-chevron-down text-slate-500 text-sm transition-transform duration-300 service-arrow"></i>
                    </div>
                    <div class="text-2xl">${config.icon}</div>
                </div>
                <div class="flex items-center space-x-2 mb-2">
                    <span class="font-bold ${config.text} text-lg">${config.message}</span>
                </div>
                <div class="hidden pt-4 mt-4 border-t border-slate-700 text-slate-400 service-details">
                    <p>${service.details}</p>
                </div>
            `;
            return card;
        };

        const fetchServiceStatus = async () => {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), FETCH_TIMEOUT);
            const startTime = performance.now();
            
            try {
                const response = await fetch(STATUS_URL, { signal: controller.signal });
                clearTimeout(timeoutId);

                const endTime = performance.now();
                const latency = endTime - startTime;

                if (!response.ok) {
                    return 'outage';
                }

                if (latency < THRESHOLDS.operational) {
                    return 'operational';
                } else if (latency < THRESHOLDS.degraded) {
                    return 'degraded';
                } else {
                    return 'outage';
                }

            } catch (error) {
                clearTimeout(timeoutId);
                console.error('Failed to fetch status:', error);
                return 'outage';
            }
        };

        const renderStatusPage = () => {
            statusContainer.innerHTML = '';
            
            services.forEach(service => {
                statusContainer.appendChild(createServiceCard(service));
            });

            updateOverallStatus();
            lastUpdatedTime.textContent = new Date().toLocaleTimeString();
        };

        const updateOverallStatus = () => {
            let overallStatus = 'operational';
            if (services.some(s => s.status === 'outage')) {
                overallStatus = 'outage';
            } else if (services.some(s => s.status === 'degraded')) {
                overallStatus = 'degraded';
            } else if (services.some(s => s.status === 'loading')) {
                overallStatus = 'loading';
            }

            const config = statusConfig[overallStatus];
            overallStatusIcon.innerHTML = config.icon;
            
            overallStatusIcon.classList.remove('animate-pulse');
            if (overallStatus === 'degraded' || overallStatus === 'outage') {
                overallStatusIcon.classList.add('animate-pulse');
            }
        };

        const updateAllServices = async () => {
            services.forEach(s => s.status = 'loading');
            renderStatusPage();
            
            const newStatus = await fetchServiceStatus();
            
            services.forEach(s => s.status = newStatus);
            
            renderStatusPage();
        };

        statusContainer.addEventListener('click', (event) => {
            let targetCard = event.target.closest('[data-service-id]');
            if (targetCard) {
                const details = targetCard.querySelector('.service-details');
                const arrow = targetCard.querySelector('.service-arrow');
                details.classList.toggle('hidden');
                arrow.classList.toggle('rotate-180');
            }
        });

        updateAllServices();
        setInterval(updateAllServices, 30000);
    </script>
</body>
</html>
